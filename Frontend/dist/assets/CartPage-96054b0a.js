import{R as z,j as e,F as f,g as D,r as _,h as $,b as L,e as p,_ as l,L as b,i as M,l as F}from"./index-e4b7f291.js";const J="_remove_item_modal_overlay_mnefl_1",T="_remove_item_modal_mnefl_1",K="_heading_mnefl_67",q="_buttons_mnefl_89",V="_btn_mnefl_103",Y="_cancel_btn_mnefl_127",B="_remove_btn_mnefl_143",r={remove_item_modal_overlay:J,remove_item_modal:T,heading:K,buttons:q,btn:V,cancel_btn:Y,remove_btn:B},H=({setShowRemoveModal:n,removeFromCart:m,productId:u})=>z.createPortal(e.jsxs("div",{className:r.remove_item_modal_overlay,onClick:()=>n(!1),children:[e.jsxs("div",{className:r.remove_item_modal,onClick:d=>d.stopPropagation(),children:[e.jsx("div",{className:r.heading,children:"Remove Item"}),e.jsx("span",{children:"Are you sure you want to remove this item?"}),e.jsxs("div",{className:r.buttons,children:[e.jsx("div",{className:`${r.btn} ${r.cancel_btn}`,onClick:()=>n(!1),children:"CANCEL"}),e.jsx("div",{className:`${r.btn} ${r.remove_btn}`,onClick:()=>m(u),children:"REMOVE"})]})]}),e.jsx(f,{icon:D,onClick:()=>n(!1)})]}),document.getElementById("modal-root")),X="/assets/cart-96897b83.webp",G="_cart_cnt_mnwje_1",Q="_missing_mnwje_13",U="_head_mnwje_33",W="_cart_details_mnwje_77",Z="_bor_btm_mnwje_91",ee="_product_mnwje_103",te="_product_det_mnwje_115",se="_det_top_mnwje_127",ce="_place_cnt_mnwje_141",ne="_place_btn_mnwje_165",ae="_price_cnt_mnwje_193",ie="_off_mnwje_211",re="_cart_item_action_mnwje_227",oe="_remove_mnwje_239",_e="_price_details_cnt_mnwje_263",le="_price_details_mnwje_263",de="_price_top_mnwje_297",me="_price_main_mnwje_311",pe="_amount_mnwje_325",ue="_save_mnwje_341",he="_authentic_mnwje_351",je="_mb_place_cnt_mnwje_377",ve="_recent_products_heading_mnwje_385",xe="_recent_products_cnt_mnwje_393",ge="_justify_between_mnwje_403",ye="_price_mnwje_193",be="_total_mnwje_545",fe="_mb_place_btn_mnwje_557",we="_recent_product_mnwje_385",Ne="_prodt_name_mnwje_651",s={cart_cnt:G,missing:Q,head:U,cart_details:W,bor_btm:Z,product:ee,product_det:te,det_top:se,place_cnt:ce,place_btn:ne,price_cnt:ae,off:ie,cart_item_action:re,remove:oe,price_details_cnt:_e,price_details:le,price_top:de,price_main:me,amount:pe,save:ue,authentic:he,mb_place_cnt:je,recent_products_heading:ve,recent_products_cnt:xe,justify_between:ge,price:ye,total:be,mb_place_btn:fe,recent_product:we,prodt_name:Ne},Pe=()=>{const[n,m]=_.useState([]),[u,d]=_.useState(!1),[o,v]=_.useState({price:0,discount:0,total:0,items:0}),[w,N]=_.useState([]),{user:h}=$(t=>t.user),C=L(),x=new Date,S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];_.useEffect(()=>{localStorage.getItem("cart")!==null&&g(JSON.parse(localStorage.getItem("cart"))),I()},[]);const g=async t=>{try{const{data:c}=await p.get(`/api/products/get-multiple?ids=${t}`);m(c)}catch(c){l.error(c.response.data.message),m([])}},I=async()=>{try{const{data:t}=await p.get("/api/products/get-recently-added");N(t)}catch(t){l.error(t.response.data.message)}},P=t=>{let c=JSON.parse(localStorage.getItem("cart"));c=c.filter(a=>a!==t),localStorage.setItem("cart",JSON.stringify(c)),g(c),d(!1),l.success("item removed from cart")},k=()=>{if(n.length){let t=0,c=0,a=0;n.forEach(i=>{t+=i.price,c+=parseInt(i.price*(100-i.discount)/100),a+=Math.ceil(i.price*i.discount/100)}),v(i=>({...i,items:n.length,price:t,discount:a,total:c}))}else v({price:0,discount:0,total:0,items:0})};_.useEffect(()=>{k()},[n]);function E(t){return new Promise(c=>{const a=document.createElement("script");a.src=t,a.onload=()=>{c(!0)},a.onerror=()=>{c(!1)},document.body.appendChild(a)})}const y=async()=>{if(!await E("https://checkout.razorpay.com/v1/checkout.js")){l.error("Razorpay SDK failed to load. Are you online?");return}const c=await p.post("/api/products/payment",{products:n});if(!c){l.error("Server error. Are you online?");return}const{amount:a,id:i,currency:R}=c.data,A={key:"rzp_test_Ao1CK0KgMgwLrb",amount:a.toString(),currency:R,name:"ShopHub Corp",description:"Test Transaction",image:F,order_id:i,handler:async function(j){const O={orderCreationId:i,razorpayPaymentId:j.razorpay_payment_id,razorpayOrderId:j.razorpay_order_id,razorpaySignature:j.razorpay_signature};(await p.post("/api/products/payment/success",{paymentDetails:O,products:n})).data.status==="Payment successful"&&(l.success("Order Placed!"),localStorage.removeItem("cart"),C("/account/orders"))},prefill:{name:"",email:"splitter@example.com",contact:"9999999999"},notes:{address:"Razorpay Corporate Office"},theme:{color:"#61dafb"}};new Razorpay(A).open()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.cart_cnt,children:n.length?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.cart_details,children:[n.map(t=>e.jsxs("div",{className:s.bor_btm,children:[e.jsxs("div",{className:s.product,children:[e.jsx("img",{src:`/api/products/photo/${t._id}`,alt:t.name,width:100,height:120}),e.jsxs("div",{className:s.product_det,children:[e.jsxs("div",{className:s.det_top,children:[e.jsx("span",{children:t.name}),e.jsxs("span",{children:["Delivery by"," ",`${x.getDate()+t.delivery} ${S[x.getMonth()]}`]})]}),e.jsxs("div",{className:s.price_cnt,children:[t.discount&&e.jsx("strike",{children:t.price}),e.jsxs("div",{children:["₹",t.discount?parseInt(t.price*(100-t.discount)/100):t.price,t.discount&&e.jsxs("span",{className:s.off,children:[t.discount,"% off"]})]})]})]})]}),e.jsxs("div",{className:s.cart_item_action,children:[e.jsx("div",{className:s.cart_quantity}),e.jsx("div",{className:s.remove,onClick:()=>d(!0),children:"REMOVE"})]}),u&&e.jsx(H,{setShowRemoveModal:d,removeFromCart:P,productId:t._id})]},t._id)),e.jsx("div",{className:s.place_cnt,children:e.jsx("div",{className:s.place_btn,onClick:y,children:"PLACE ORDER"})})]}),e.jsxs("div",{className:s.price_details_cnt,children:[e.jsxs("div",{className:s.price_details,children:[e.jsx("div",{className:s.price_top,children:"PRICE DETAILS"}),e.jsxs("div",{className:s.price_main,children:[e.jsxs("div",{className:s.justify_between,children:[e.jsxs("div",{children:["Price (",o.items," items)"]})," ",e.jsxs("div",{children:["₹",o.price]})]}),e.jsxs("div",{className:s.justify_between,children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:s.save,children:["-₹",o.discount]})]}),e.jsxs("div",{className:s.justify_between,children:[e.jsx("div",{children:"Delivery Charges"}),e.jsxs("div",{children:[e.jsx("strike",{children:"100"}),e.jsx("span",{className:s.save,children:" Free"})]})]}),e.jsxs("div",{className:`${s.amount} ${s.justify_between}`,children:[e.jsx("div",{children:"Total Amount"}),e.jsxs("div",{children:["₹",o.total]})]}),e.jsxs("div",{className:s.save,children:["You will save ₹",o.discount," on this order"]})]})]}),e.jsxs("div",{className:s.authentic,children:[e.jsx(f,{icon:M}),"Safe and Secure Payments.Easy returns.100% Authentic products."]}),e.jsxs("div",{className:s.mb_place_cnt,children:[e.jsxs("div",{className:s.price,children:[e.jsx("strike",{children:o.price}),e.jsx("div",{className:s.total,children:o.total})]}),e.jsx("div",{className:s.mb_place_btn,onClick:y,children:"PLACE ORDER"})]})]})]}):e.jsxs("div",{className:s.missing,children:[e.jsx("img",{width:222,height:162,src:X,alt:"no-item-in-cart"}),e.jsx("div",{className:s.head,children:h?"Your cart is empty!":"Missing Cart items?"}),e.jsx("span",{children:h?"Add items to it now.":"Login to see things you added previously"}),h?e.jsx(b,{to:"/",style:{background:"#2874f0"},children:"Shop now"}):e.jsx(b,{to:"/login",children:"Login"})]})}),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.recent_products_heading,children:"Recently Added"}),e.jsx("div",{className:s.recent_products_cnt,children:w.map(t=>e.jsxs("div",{className:s.recent_product,children:[e.jsx("img",{src:`/api/products/photo/${t._id}`,alt:t.name,width:120,height:148}),e.jsx("div",{className:s.prodt_name,children:t.name.length>16?t.name.substr(0,15)+"...":t.name}),e.jsx("div",{className:s.price_cnt,children:e.jsxs("div",{children:["₹",t.discount?parseInt(t.price*(100-t.discount)/100):t.price,t.discount&&e.jsx("strike",{children:t.price})]})}),t.discount&&e.jsxs("div",{style:{color:"rgb(0, 140, 0)",fontSize:"12px"},children:[t.discount,"% off"]})]},t._id))})]})]})};export{Pe as default};
