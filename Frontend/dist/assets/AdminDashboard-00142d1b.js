import{r as l,a as A,e as _,_ as m,j as s,F as f,N as S,L as d,d as P}from"./index-e4b7f291.js";import{h as E}from"./moment-fbc5633a.js";const C="_login_cnt_1y3pi_3",$="_admin_login_1y3pi_15",D="_password_1y3pi_67",I="_login_btn_1y3pi_79",L="_nav_1y3pi_111",O="_nav_menu_1y3pi_129",k="_admin_body_1y3pi_155",F="_admin_dashboard_1y3pi_175",J="_orders_sec_1y3pi_193",R="_order_1y3pi_193",B="_order_header_1y3pi_221",M="_order_detail_1y3pi_239",V="_prodt_1y3pi_261",Y="_img_cnt_1y3pi_279",q="_prodt_det_1y3pi_307",z="_name_1y3pi_321",G="_rating_1y3pi_333",H="_off_1y3pi_353",K="_left_cnt_1y3pi_363",Q="_data_section_1y3pi_403",a={login_cnt:C,admin_login:$,password:D,login_btn:I,nav:L,nav_menu:O,admin_body:k,admin_dashboard:F,orders_sec:J,order:R,order_header:B,order_detail:M,prodt:V,img_cnt:Y,prodt_det:q,name:z,rating:G,off:H,left_cnt:K,data_section:Q},W=()=>{const[h,g]=l.useState({}),[r,u]=l.useState({login:"",password:"",showPass:!1}),[o,p]=l.useState([]),t=A().pathname.substring(7),N=["On the way","Delivered","Cancelled","Returned"];l.useEffect(()=>{localStorage.getItem("admin-shophub")&&g(JSON.parse(localStorage.getItem("admin-shophub"))),t!==""&&x()},[]);const w=async e=>{e.preventDefault();try{const{data:n}=await _.post("/api/auth/admin-login",{email:r.login,phone:parseInt(r.login),password:r.password});localStorage.setItem("admin-shophub",JSON.stringify(n)),g(n),m.success(`${n.username} logged in`)}catch(n){m.error(n.response.data.message)}};l.useEffect(()=>{p([]),t!==""&&x()},[t]);const x=async()=>{try{let e;t==="products"?e=await _.get("/api/products/get-all"):t==="category"?e=await _.get("/api/category/get-all"):t==="orders"&&(e=await _.get("/api/auth/get-all-orders"),console.log(e.data)),p(e.data)}catch(e){m.error(e.response.data.message)}},b=async(e,n)=>{try{const{data:c}=await _.put(`/api/auth/update-order/${e}`,{status:n});m.success(c.message)}catch(c){m.error(c.response.data.message)}};return s.jsx("div",{children:h.username?s.jsxs("div",{children:[s.jsxs("div",{className:a.nav,children:[s.jsx(d,{to:"/admin",children:"Admin Dashboard"}),s.jsxs("div",{className:a.nav_menu,children:[s.jsx(d,{to:"/admin/products",children:"Products"}),s.jsx(d,{to:"/admin/category",children:"Categories"}),s.jsx(d,{to:"/admin/orders",children:"Orders"})]})]}),s.jsxs("div",{className:a.admin_dashboard,children:[s.jsxs("div",{className:a.left_cnt,children:[s.jsx(d,{to:"/admin/add-new/category",children:"Add Category"}),s.jsx(d,{to:"/admin/add-new/products",children:"Add Product"})]}),s.jsx("div",{className:a.right_cnt,children:t===""?s.jsxs("div",{className:a.admin_body,children:[s.jsxs("div",{children:["Admin Name: ",h.username]}),s.jsxs("div",{children:["Admin Email: ",h.email]}),s.jsxs("div",{children:["Admin Contact: ",h.phone]})]}):t==="orders"?s.jsx("div",{className:a.orders_sec,children:o.map((e,n)=>{var c,j,v,y;return s.jsxs("div",{className:a.order,children:[s.jsxs("div",{className:a.order_header,children:[s.jsx("div",{children:"#"}),s.jsx("div",{children:"Status"}),s.jsx("div",{children:"Buyer"}),s.jsx("div",{children:"Amount"}),s.jsx("div",{children:"Payment"}),s.jsx("div",{children:"Date"})]}),s.jsxs("div",{className:a.order_detail,children:[s.jsx("div",{children:n+1}),s.jsx("select",{onChange:i=>b(e._id,i.target.value),defaultValue:e==null?void 0:e.status,children:N.map(i=>s.jsx("option",{value:i,children:i},i))}),s.jsx("div",{children:(c=e==null?void 0:e.buyer)==null?void 0:c.username}),s.jsxs("div",{children:["₹",parseInt(((j=e==null?void 0:e.payment)==null?void 0:j.amount)/100)]}),s.jsx("div",{children:(v=e==null?void 0:e.payment)==null?void 0:v.status}),s.jsx("div",{children:E(e==null?void 0:e.createdAt).fromNow()})]}),(y=e==null?void 0:e.products)==null?void 0:y.map(i=>s.jsxs(d,{to:"",className:a.prodt,children:[s.jsx("div",{className:a.img_cnt,children:s.jsx("img",{src:`/api/products/photo/${i._id}`,alt:`${i.name}-image`})}),s.jsxs("div",{className:a.prodt_det,children:[s.jsx("div",{className:a.name,children:i.name}),s.jsxs("div",{className:a.rating,children:[i.rating,s.jsx(f,{icon:P})]}),s.jsxs("div",{children:["Price: ₹",i.price]}),s.jsxs("div",{children:["Discount:"," ",s.jsxs("span",{className:a.off,children:[i.discount,"% off"]})]})]})]},i._id))]},e._id)})}):o&&s.jsx("div",{className:a.data_section,children:o==null?void 0:o.map(e=>{var n,c;return s.jsxs(d,{to:`/admin/${t}/${e._id}`,children:[s.jsx("div",{className:a.img_cnt,children:s.jsx("img",{src:`/api/${t==="category"?"category":"products"}/photo/${e._id}`,alt:e==null?void 0:e.name,width:"auto",height:"auto"})}),s.jsx("div",{children:((n=e==null?void 0:e.name)==null?void 0:n.length)>17?((c=e==null?void 0:e.name)==null?void 0:c.substr(0,17))+"...":e==null?void 0:e.name})]},e._id)})})})]})]}):s.jsx("div",{className:a.login_cnt,children:s.jsxs("form",{onSubmit:w,className:a.admin_login,children:[s.jsx("h2",{children:"Admin Login"}),s.jsx("input",{type:"text",value:r.login,placeholder:"Enter Your Email/Mobile Number",onChange:e=>u(n=>({...n,login:e.target.value})),autoFocus:!0}),s.jsxs("div",{className:a.password,children:[s.jsx("input",{type:r.showPass?"text":"password",value:r.password,placeholder:"Enter Password",onChange:e=>u(n=>({...n,password:e.target.value}))}),s.jsx(f,{icon:S,onClick:()=>u(e=>({...e,showPass:!e.showPass})),style:{cursor:"pointer"}})]}),s.jsx("button",{type:"submit",className:a.login_btn,children:"Login"})]})})})};export{W as default};
