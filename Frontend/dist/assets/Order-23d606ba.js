import{r as d,h as A,b as S,j as e,L as m,F as n,z as x,g as j,A as D,y as E,B as F,e as O,_ as $}from"./index-e4b7f291.js";import{h as w}from"./moment-fbc5633a.js";import{a7 as k}from"./index-d1e02287.js";const M="_links_htkui_1",V="_order_cnt_htkui_37",L="_order_left_htkui_53",T="_filter_section_htkui_67",Y="_filter_types_htkui_77",I="_clear_all_htkui_97",z="_applied_filters_htkui_109",B="_btn_lgt_htkui_119",G="_filter_head_htkui_155",H="_section_head_htkui_165",U="_options_htkui_175",W="_mb_apply_btn_htkui_189",X="_order_right_htkui_199",q="_search_bar_htkui_215",J="_cross_htkui_255",K="_search_btn_htkui_279",P="_mb_filter_htkui_311",Q="_all_orders_htkui_321",Z="_img_cnt_htkui_351",ee="_product_details_htkui_379",se="_product_htkui_379",te="_price_htkui_399",ie="_date_htkui_407",ae="_Delivered_htkui_425",le="_Cancelled_htkui_431",re="_Returned_htkui_437",ce="_d_non_htkui_629",i={links:M,order_cnt:V,order_left:L,filter_section:T,filter_types:Y,clear_all:I,applied_filters:z,btn_lgt:B,filter_head:G,section_head:H,options:U,mb_apply_btn:W,order_right:X,search_bar:q,cross:J,search_btn:K,mb_filter:P,all_orders:Q,img_cnt:Z,product_details:ee,product:se,price:te,date:ie,Delivered:ae,Cancelled:le,Returned:re,d_non:ce},oe=()=>{const[h,g]=d.useState([]),[c,_]=d.useState([]),[l,r]=d.useState({status:[],search:"",time:[],mbVisible:!1}),{user:f}=A(s=>s.user),b=S(),v=["On the way","Delivered","Cancelled","Returned"],p=[{title:"Last 30 Days",value:30},{title:"2023",value:365}],u=async()=>{try{const{data:s}=await O.get(`/api/auth/single-user-orders?search=${l.search}&status=${l.status}&time=${l.time}`);g(s)}catch(s){$.error(s.response.data.message)}};d.useEffect(()=>{u()},[]),d.useEffect(()=>{f||b("/login")},[f]);const N=(s,a)=>{s.target.checked?(r(t=>({...t,status:[...t.status,a]})),_([...c,a])):(r(t=>({...t,status:l.status.filter(o=>o!==a)})),_(c.filter(t=>t!==a)))},y=(s,a)=>{s.target.checked?(r(t=>({...t,time:[...t.time,a.value]})),_([...c,a.title])):(r(t=>({...t,time:t.time.filter(o=>o!==a.value)})),_(c.filter(t=>t!==a.title)))};d.useEffect(()=>{l.search?window.innerWidth<=420&&u():u()},[l]);const C=s=>{if(_(c.filter(a=>a!==s)),l.status.length&&r(a=>({...a,status:a.status.filter(t=>t!==s)})),l.time.length){let a;p.forEach(t=>{if(t.title===s){a=t.value;return}}),r(t=>({...t,time:t.time.filter(o=>o!==a)}))}},R=()=>{r({search:"",status:[],time:[],mbVisible:!1}),_([])};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:i.links,children:[e.jsx(m,{to:"/",children:"Home"}),e.jsx(n,{icon:x}),e.jsx(m,{to:"/account/profile",children:"My Account"}),e.jsx(n,{icon:x}),e.jsx(m,{to:"/account/orders",children:"My Orders"})]}),e.jsxs("div",{className:i.order_cnt,children:[e.jsxs("div",{className:`${i.order_left} ${l.mbVisible?"":i.d_non}`,children:[e.jsx("div",{className:i.filter_section,children:e.jsxs("div",{className:i.filter_types,children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{className:i.filter_head,children:"Filters"}),c.length?e.jsx("div",{className:i.clear_all,onClick:R,children:"CLEAR ALL"}):""]}),e.jsx("div",{className:i.applied_filters,children:c&&(c==null?void 0:c.map((s,a)=>e.jsxs("div",{className:i.btn_lgt,onClick:()=>C(s),children:[e.jsx(n,{icon:j,style:{marginRight:"4px"}}),s]},a)))})]})}),e.jsxs("div",{className:i.filter_section,children:[e.jsx("div",{className:i.section_head,children:"ORDER STATUS"}),e.jsx("div",{className:i.options,children:v.map((s,a)=>e.jsx(k,{checked:l.status.includes(s),onChange:t=>N(t,s),children:s},a))})]}),e.jsxs("div",{className:i.filter_section,children:[e.jsx("div",{className:i.section_head,children:"ORDER TIME"}),e.jsx("div",{className:i.options,children:p.map(s=>e.jsx(k,{checked:l.time.includes(s.value),onChange:a=>y(a,s),children:s.title},s.value))})]}),e.jsx("div",{className:i.mb_apply_btn,onClick:()=>r(s=>({...s,mbVisible:!1})),children:"Apply"})]}),e.jsxs("div",{className:i.order_right,children:[e.jsxs("div",{className:i.search_bar,children:[e.jsx("input",{type:"text",placeholder:"Search your orders here",onChange:s=>r(a=>({...a,search:s.target.value})),value:l.search}),l.search&&e.jsx(n,{className:i.cross,icon:j,onClick:()=>{r(s=>({...s,search:""}))}}),e.jsxs("div",{className:i.search_btn,onClick:()=>u(),children:[e.jsx(n,{icon:D}),"Search Orders"]}),e.jsxs("div",{className:i.mb_filter,onClick:()=>r(s=>({...s,mbVisible:!s.mbVisible})),children:[e.jsx(n,{icon:E}),"Filters"]})]}),h.length?e.jsx(e.Fragment,{children:h==null?void 0:h.map(s=>{var a;return(a=s==null?void 0:s.products)==null?void 0:a.map(t=>e.jsxs("div",{className:i.all_orders,children:[e.jsx("div",{className:i.img_cnt,children:e.jsx("img",{src:`/api/products/photo/${t._id}`,alt:t.name,width:"auto",height:"auto"})}),e.jsxs("div",{className:i.product_details,children:[e.jsx("div",{className:i.product,children:t.name.length>20?t.name.substr(0,40)+"...":t.name}),e.jsxs("div",{className:i.price,children:["â‚¹",parseInt(t.price*(100-t.discount)/100)]}),e.jsxs("div",{children:[e.jsxs("div",{className:`${i.date} `,children:[e.jsx(n,{icon:F,className:i[s==null?void 0:s.status]}),` ${s.status} on ${w(s.updatedAt).format("DD MMM YYYY")}`]}),s.status==="Delivered"?e.jsx("div",{style:{fontSize:"12px"},children:"Your item has been delivered"}):""]})]})]},t._id))})}):""]})]})]})};export{oe as default};
