import{r as d,h as A,b as S,j as s,L as u,F as n,z as p,g as x,A as D,y as E,B as F,e as O,_ as $}from"./index-3d8f536d.js";import{h as w}from"./moment-fbc5633a.js";import{a7 as j}from"./index-b21de98d.js";const M="_links_1visl_1",V="_order_cnt_1visl_37",L="_order_left_1visl_53",T="_filter_section_1visl_67",Y="_filter_types_1visl_77",I="_clear_all_1visl_97",z="_applied_filters_1visl_109",B="_btn_lgt_1visl_119",G="_filter_head_1visl_155",H="_section_head_1visl_165",U="_options_1visl_175",W="_mb_apply_btn_1visl_189",X="_order_right_1visl_199",q="_search_bar_1visl_215",J="_cross_1visl_255",K="_search_btn_1visl_279",P="_mb_filter_1visl_311",Q="_all_orders_1visl_321",Z="_img_cnt_1visl_351",ss="_product_details_1visl_379",es="_product_1visl_379",ts="_price_1visl_399",ls="_date_1visl_407",is="_Delivered_1visl_425",as="_Cancelled_1visl_431",rs="_Returned_1visl_437",cs="_d_non_1visl_613",l={links:M,order_cnt:V,order_left:L,filter_section:T,filter_types:Y,clear_all:I,applied_filters:z,btn_lgt:B,filter_head:G,section_head:H,options:U,mb_apply_btn:W,order_right:X,search_bar:q,cross:J,search_btn:K,mb_filter:P,all_orders:Q,img_cnt:Z,product_details:ss,product:es,price:ts,date:ls,Delivered:is,Cancelled:as,Returned:rs,d_non:cs},os=()=>{const[h,g]=d.useState([]),[c,_]=d.useState([]),[a,r]=d.useState({status:[],search:"",time:[],mbVisible:!1}),{user:v}=A(e=>e.user),b=S(),N=["On the way","Delivered","Cancelled","Returned"],f=[{title:"Last 30 Days",value:30},{title:"2023",value:365}],m=async()=>{try{const{data:e}=await O.get(`/api/auth/single-user-orders?search=${a.search}&status=${a.status}&time=${a.time}`);g(e)}catch(e){$.error(e.response.data.message)}};d.useEffect(()=>{m()},[]),d.useEffect(()=>{v||b("/login")},[v]);const y=(e,i)=>{e.target.checked?(r(t=>({...t,status:[...t.status,i]})),_([...c,i])):(r(t=>({...t,status:a.status.filter(o=>o!==i)})),_(c.filter(t=>t!==i)))},k=(e,i)=>{e.target.checked?(r(t=>({...t,time:[...t.time,i.value]})),_([...c,i.title])):(r(t=>({...t,time:t.time.filter(o=>o!==i.value)})),_(c.filter(t=>t!==i.title)))};d.useEffect(()=>{a.search?window.innerWidth<=412&&m():m()},[a]);const C=e=>{if(_(c.filter(i=>i!==e)),a.status.length&&r(i=>({...i,status:i.status.filter(t=>t!==e)})),a.time.length){let i;f.forEach(t=>{if(t.title===e){i=t.value;return}}),r(t=>({...t,time:t.time.filter(o=>o!==i)}))}},R=()=>{r({search:"",status:[],time:[],mbVisible:!1}),_([])};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:l.links,children:[s.jsx(u,{to:"/",children:"Home"}),s.jsx(n,{icon:p}),s.jsx(u,{to:"/account/profile",children:"My Account"}),s.jsx(n,{icon:p}),s.jsx(u,{to:"/account/orders",children:"My Orders"})]}),s.jsxs("div",{className:l.order_cnt,children:[s.jsxs("div",{className:`${l.order_left} ${a.mbVisible?"":l.d_non}`,children:[s.jsx("div",{className:l.filter_section,children:s.jsxs("div",{className:l.filter_types,children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("div",{className:l.filter_head,children:"Filters"}),c.length?s.jsx("div",{className:l.clear_all,onClick:R,children:"CLEAR ALL"}):""]}),s.jsx("div",{className:l.applied_filters,children:c&&(c==null?void 0:c.map((e,i)=>s.jsxs("div",{className:l.btn_lgt,onClick:()=>C(e),children:[s.jsx(n,{icon:x,style:{marginRight:"4px"}}),e]},i)))})]})}),s.jsxs("div",{className:l.filter_section,children:[s.jsx("div",{className:l.section_head,children:"ORDER STATUS"}),s.jsx("div",{className:l.options,children:N.map((e,i)=>s.jsx(j,{checked:a.status.includes(e),onChange:t=>y(t,e),children:e},i))})]}),s.jsxs("div",{className:l.filter_section,children:[s.jsx("div",{className:l.section_head,children:"ORDER TIME"}),s.jsx("div",{className:l.options,children:f.map(e=>s.jsx(j,{checked:a.time.includes(e.value),onChange:i=>k(i,e),children:e.title},e.value))})]}),s.jsx("div",{className:l.mb_apply_btn,onClick:()=>r(e=>({...e,mbVisible:!1})),children:"Apply"})]}),s.jsxs("div",{className:l.order_right,children:[s.jsxs("div",{className:l.search_bar,children:[s.jsx("input",{type:"text",placeholder:"Search your orders here",onChange:e=>r(i=>({...i,search:e.target.value})),value:a.search}),a.search&&s.jsx(n,{className:l.cross,icon:x,onClick:()=>{r(e=>({...e,search:""}))}}),s.jsxs("div",{className:l.search_btn,onClick:()=>m(),children:[s.jsx(n,{icon:D}),"Search Orders"]}),s.jsxs("div",{className:l.mb_filter,onClick:()=>r(e=>({...e,mbVisible:!e.mbVisible})),children:[s.jsx(n,{icon:E}),"Filters"]})]}),h.length?s.jsx(s.Fragment,{children:h==null?void 0:h.map(e=>{var i;return(i=e==null?void 0:e.products)==null?void 0:i.map(t=>s.jsxs("div",{className:l.all_orders,children:[s.jsx("div",{className:l.img_cnt,children:s.jsx("img",{src:`/api/products/photo/${t._id}`,alt:t.name,width:"auto",height:"auto"})}),s.jsxs("div",{className:l.product_details,children:[s.jsx("div",{className:l.product,children:t.name.length>20?t.name.substr(0,40)+"...":t.name}),s.jsxs("div",{className:l.price,children:["â‚¹",parseInt(t.price*(100-t.discount)/100)]}),s.jsxs("div",{children:[s.jsxs("div",{className:`${l.date} `,children:[s.jsx(n,{icon:F,className:l[e==null?void 0:e.status]}),` ${e.status} on ${w(e.updatedAt).format("DD MMM YYYY")}`]}),e.status==="Delivered"?s.jsx("div",{style:{fontSize:"12px"},children:"Your item has been delivered"}):""]})]})]},t._id))})}):""]})]})]})};export{os as default};
